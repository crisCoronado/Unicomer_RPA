{"triggers":[],"nodes":[{"uid":"a0f027bd-90d2-4452-83c8-f60459ccc69e","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"4e304600-ce08-4878-b873-7e2a0289e3ec","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","packageName":"System","variableName":"Date"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","string":"dd-MM-yyyy hhmmss"}}],"returnTo":{"type":"VARIABLE","variableName":"dateLogsFile"}},{"uid":"fad8c56a-934f-46bb-9a07-021bd52e33fe","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/AsignacionDeOmisiones/Processes/Bi/LoginBi"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"DICTIONARY","dictionary":[{"key":"out_isLoginSuccess","value":{"type":"VARIABLE","variableName":"isLoginSuccess"}}]}},{"uid":"980719b6-827c-40a0-b2e0-8e1e12609bd8","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$@pathLogsFileOmissions$\\Asignacion Omisiones $dateLogsFile$.txt"}}],"returnTo":{"type":"VARIABLE","variableName":"logsFile"}},{"uid":"521db2d2-71e5-43a1-9450-3259af3febde","commandName":"createFile","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$logsFile$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"e464d5be-f2ed-4433-9050-e42cfced9953","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"620df5dc-b850-4fd6-8579-8a46ff32b1ad","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/AsignacionDeOmisiones/Processes/Bi/downloadOmissionsReport"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"DICTIONARY","dictionary":[{"key":"out_listReportsToProcess","value":{"type":"VARIABLE","variableName":"listReportsToProcess"}}]}},{"uid":"b95f455c-b149-4a49-99c5-27e5b736be90","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/AsignacionDeOmisiones/Processes/Bi/logoutBi"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"6c0be01c-dc49-456a-9843-beb98a9855eb","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"d0ff272a-057f-49af-a274-61a8368d802b","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"pruebas"}}]},{"uid":"c7f97eac-b5bd-4a6b-8fb1-a1aa83dcb745","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"26139941-4d7f-47d3-8462-a702db7a1e37","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"C:\\Users\\cristian_coronado\\Documents\\Proyectos RPA\\Asignacion de Omisiones\\DEV\\Reports\\Omisiones La Curacao 29-03-2022 032917 testv02 - Copy.xlsx"}}],"returnTo":{"type":"VARIABLE","variableName":"currentReport"}},{"uid":"601b73b8-e2a2-48e1-bc42-a427cd905c23","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"in_reportPath","value":{"type":"STRING","expression":"$currentReport$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/AsignacionDeOmisiones/Processes/Excel/readReportToProcess"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"DICTIONARY","dictionary":[{"key":"out_DtOmissions","value":{"type":"VARIABLE","variableName":"DtOmissions"}}]}},{"uid":"cb152148-78e2-4c68-a3be-aa933d7336e1","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"in_DtOmissions","value":{"type":"TABLE","expression":"$DtOmissions$"}},{"key":"in_logsFile","value":{"type":"STRING","expression":"$logsFile$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/AsignacionDeOmisiones/Processes/API/AssingAndSendOmissions"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$currentReport$"}},{"name":"operator","value":{"type":"STRING","string":"NOTINCLUDE"}},{"name":"value","value":{"type":"STRING","string":"Opticas"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"currentReport"},"attributes":[{"name":"list","value":{"type":"VARIABLE","variableName":"listReportsToProcess"}},{"name":"forOptions","value":{"type":"STRING","string":"all"}}],"value":{"type":"ITERATOR","iteratorName":"list.iterators.list","packageName":"List"}}]},{"uid":"4c4f17fa-6dad-4a15-9f04-bbb3eae32732","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","string":"pablo_tezo@unicomer.com"}},{"name":"cc","value":{"type":"STRING","string":"cristian_coronado@unicomer.com"}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","string":"ASIGNACION DE OMISIONES | RPA"}},{"name":"attachmentsFilePath","value":{"type":"FILE","expression":"file://$logsFile$"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","string":"Buen día, \nel proceso automatizado para 'ASIGNACIÓN DE OMISIONES' ha finalizado correctamente.\n\nAdicional, se adjunta archivo de logs de ejecución.\n\nSaludos,\nMr. Botsín."}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":true}},{"name":"serverType","value":{"type":"STRING","string":"OUTLOOK"}}]}],"branches":[{"uid":"e82282e3-0ba6-49f8-98a2-b96722fc40d6","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"e272b407-2693-4c23-8f33-e86dbde6a1cb","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","packageName":"System","variableName":"Date"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","string":"dd-MM-yyyy hhmmss"}}],"returnTo":{"type":"VARIABLE","variableName":"dateLogsFile"}},{"uid":"cdfb8bb2-b184-4e5c-8de2-8b02e3e0d2b9","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$@pathLogsFileOmissions$/Capture Error $dateLogsFile$.png"}}],"returnTo":{"type":"VARIABLE","variableName":"errorScreenShot"}},{"uid":"25d5c383-c3ba-4cba-9bac-fe9b77d90ac6","commandName":"captureDesktop","packageName":"Screen","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$errorScreenShot$"}},{"name":"isOverwriteFile","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"7ffacd9e-28aa-468e-8de5-b8a8e6ea9934","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","string":"pablo_tezo@unicomer.com"}},{"name":"cc","value":{"type":"STRING","string":"cristian_coronado@unicomer.com"}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","string":"ASIGNACION DE OMISIONES | RPA"}},{"name":"attachmentsFilePath","value":{"type":"FILE","expression":"file://$errorScreenShot$"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","string":"Buen día, \nel proceso automatizado para 'ASIGNACIÓN DE OMISIONES' ha finalizado,\ndebido a que no fue posible iniciar sesión en el aplicativo Bi.\n\nFavor validar credenciales y ejecutar el proceso nuevamente.\n\nSaludos,\nMr. Botsín."}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":true}},{"name":"serverType","value":{"type":"STRING","string":"OUTLOOK"}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"BOOLEAN","expression":"$isLoginSuccess$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"booleanVariable","packageName":"Boolean"}}]}],"branches":[{"uid":"ded35f46-eb0f-476a-b9e1-d5f47839a064","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"0df5a5e9-01d0-46cc-a281-9b65127dd2e5","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","packageName":"System","variableName":"Date"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","string":"dd-MM-yyyy hhmmss"}}],"returnTo":{"type":"VARIABLE","variableName":"dateLogsFile"}},{"uid":"2d8c9f52-e812-4195-b8db-1177da3e90d1","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$@pathLogsFileOmissions$/Capture Error $dateLogsFile$.png"}}],"returnTo":{"type":"VARIABLE","variableName":"errorScreenShot"}},{"uid":"fef37e0a-da39-4124-a0c0-4600259ec31a","commandName":"captureDesktop","packageName":"Screen","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$errorScreenShot$"}},{"name":"isOverwriteFile","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"d8087c4f-1eab-4fe1-8d9b-f565c0904847","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","string":"pablo_tezo@unicomer.com"}},{"name":"cc","value":{"type":"STRING","string":"cristian_coronado@unicomer.com"}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","string":"ERROR ASIGNACION DE OMISIONES | RPA"}},{"name":"attachmentsFilePath","value":{"type":"FILE","expression":"file://$errorScreenShot$"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"Buen día, \nel proceso automatizado para 'ASIGNACIÓN DE OMISIONES' ha finalizado,\ndebido a un error inesperado: $errorMessage$\n\nSi el error continúa, favor comunicarse con el administrador del sistema.\n\nSaludos,\nMr. Botsín.\n"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":true}},{"name":"serverType","value":{"type":"STRING","string":"OUTLOOK"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"errorMessage"}}}]},{"uid":"678b512c-d07b-48e4-9cc5-b856622b342b","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"1c84aae4-4679-41aa-922b-4ad2699d9cb1","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/AsignacionDeOmisiones/Processes/Bi/logoutBi"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[{"uid":"4d8e2a28-b656-4f6d-993c-0d73dd4352fd","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"ba67038d-6490-4547-86a7-67bd8ac4f4b8","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"no fue posible cerrar sesión en Bi"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}]}]},{"uid":"ec7464a4-2f99-4101-8098-debaa1db5852","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/AsignacionDeOmisiones/Processes/LogicLayer/killProccesses"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"isLoginSuccess","description":"","type":"BOOLEAN","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":false}},{"name":"listReportsToProcess","description":"","type":"LIST","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"LIST","list":[]}},{"name":"currentReport","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"DtOmissions","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"TABLE","table":{"schema":[{"type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"dateLogsFile","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"logsFile","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"errorScreenShot","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"errorMessage","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}}],"breakpoints":[],"packages":[{"name":"Boolean","version":"2.2.0-20211011-141617"},{"name":"Comment","version":"2.8.0-20211011-141641"},{"name":"Datetime","version":"2.3.0-20211011-141659"},{"name":"Email","version":"3.8.0-20211122-062547"},{"name":"ErrorHandler","version":"2.8.0-20211011-141720"},{"name":"File","version":"5.2.0-20211011-141723"},{"name":"If","version":"3.1.0-20211011-141741"},{"name":"List","version":"2.5.0-20211016-065558"},{"name":"Loop","version":"3.1.0-20211011-141812"},{"name":"Screen","version":"2.4.0-20211011-142133"},{"name":"String","version":"5.0.0-20211011-142159"},{"name":"System","version":"3.5.0-20211013-180046"},{"name":"TaskBot","version":"2.2.0-20211016-070434"}],"migrationJournalReviewIds":[],"workItemTemplateName":null,"properties":{"botCodeVersion":"2","improvedNumberSupport":true,"timeout":"0s","automationPriority":"PRIORITY_MEDIUM"}}